{% extends 'admin/adminbase.html' %}

{% block head %}
{{ super() }}
<script src="{{ url_for('static', filename='vendor/js/jquery.dataTables.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/js/dataTables.bootstrap.min.js') }}"></script>
<link href="{{ url_for('static', filename='vendor/css/dataTables.bootstrap.min.css') }}" rel="stylesheet" />
{% endblock %}

{% block header %}Template Submissions{% endblock %}

{% block admincontent %}
<table id="submissions" class="table table-striped table-bordered table-compact" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th>Team</th>
      <th>Status</th>
      <th>Score</th>
      <th>Max Score</th>
      <th>Submitted</th>
      <th></th>
    </tr>
  </thead>
</table>
<script>
  $(document).ready(function () {
    $.fn.dataTable.ext.errMode = 'none';

    var dt = $('#submissions').DataTable({
      "ajax": "/api/admin/injects/template/{{ template_id }}/submissions",
      "columns": [
        { "data": "team" },
        {
          "data": "status",
          "render": function (data) {
            if (data == "Submitted" || data == "Resubmitted") {
              return '<span class="badge bg-success">' + data + '</span>';
            } else if (data == "Graded") {
              return '<span class="badge bg-info text-white">' + data + '</span>';
            } else if (data == "Revision Requested") {
              return '<span class="badge bg-warning text-dark">' + data + '</span>';
            } else if (data == "Draft") {
              return '<span class="badge bg-secondary">' + data + '</span>';
            } else {
              return '<span class="badge bg-secondary">' + data + '</span>';
            }
          }
        },
        { "data": "score" },
        { "data": "max_score" },
        { "data": "submitted" },
        {
          "data": "id",
          "render": function (data) {
            return '<a href="/admin/injects/' + data + '" class="btn btn-sm btn-primary">View</a>';
          }
        }
      ],
      "lengthChange": false,
      "ordering": true,
      "searching": false
    });
  });
</script>
{% endblock %}
